import{r as x,a as g,o as N,b as m,c as p,d as r,w as M,v as I,F as T,e as j,u as C,t as b,f as P}from"./vendor.a08634e2.js";const S=function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))d(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function u(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerpolicy&&(n.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?n.credentials="include":s.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function d(s){if(s.ep)return;s.ep=!0;const n=u(s);fetch(s.href,n)}};S();const U={class:"h-100 d-flex"},$=r("div",{class:"h-100 flex-shrink-0 left-div"},null,-1),q={class:"h-100 flex-grow-1 right-div"},A={class:"h-100 d-flex flex-column"},B={class:"w-100 flex-grow-1 main-div"},Q={class:"position-relative"},z={class:"w-100 flex-shrink-0 bottom-div"},K={class:"d-flex align-items-center"},R={class:"my-1 flex-grow-1"},G=["value"],J=["value"],X=r("div",{class:"my-1 flex-shrink-0"},[r("button",{class:"mx-1 px-5 btn btn-primary"},"\u62CD\u7167")],-1),Y={setup(E){const c=x([]),u=g(-1),d=g(null),s=g(null),n=x([]),l=g(-1),k=x({}),D=g(1);async function F(){await O(),c.find(i=>!!i.name)||((await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(e=>{e.stop()}),await O()),c.length>0&&(u.value=0,_())}async function O(){c.length=0;const i=await navigator.mediaDevices.enumerateDevices();for(let t=0;t<i.length;t++){const e=i[t];e.kind=="videoinput"&&c.push({name:e.label,path:e.deviceId})}}async function _(){const i=c[u.value],t=n[l.value];H();const e=d.value,o=await navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:i.path},width:t?{exact:t.width}:void 0,height:t?{exact:t.height}:void 0}});e.srcObject=o,await e.play();const f=o.getVideoTracks();let h=0,v=0,w=0;try{const a=f[0].getCapabilities();h=a.width.max,v=a.height.max}catch(a){console.error(a)}try{w=f[0].getSettings().frameRate}catch(a){console.error(a)}k.width=h,k.height=v,D.value=w>0?w:15,n.length=0,[{width:2592,height:1944},{width:2048,height:1536},{width:1600,height:1200},{width:1280,height:960},{width:1024,height:768},{width:640,height:480},{width:320,height:240},{width:1920,height:1080},{width:1280,height:720}].forEach(a=>{a.width<=h&&a.height<=v&&n.push({width:a.width,height:a.height})});const V=e.videoWidth,L=e.videoHeight;l.value=n.findIndex(a=>a.width==V&&a.height==L||a.width==L&&a.height==V),setTimeout(()=>{W()},0)}function H(){const i=d.value,t=i.srcObject;t&&t.getTracks().forEach(o=>{o.stop()}),i.srcObject=null}function W(){const i=d.value,t=s.value,e=1e3/D.value;let o=performance.now(),f=0;function h(){if(!i.srcObject)return;if(i.getVideoPlaybackQuality){const y=i.getVideoPlaybackQuality().totalVideoFrames;if(y>0&&y<=f){setTimeout(h,1);return}f=y}(t.width!=i.videoWidth||t.height!=i.videoHeight)&&(t.width=i.videoWidth,t.height=i.videoHeight,alert(`${t.width} x ${t.height}`));const v=performance.now();o=Math.max(o+e,v+1),setTimeout(h,o-v)}h()}return N(()=>{F()}),(i,t)=>(m(),p("div",U,[$,r("div",q,[r("div",A,[r("div",B,[r("div",Q,[r("video",{ref:(e,o)=>{o.domVideo=e,d.value=e},class:"position-absolute",playsinline:""},null,512),r("canvas",{ref:(e,o)=>{o.domCanvas=e,s.value=e},class:"position-absolute"},null,512)])]),r("div",z,[r("div",K,[r("div",R,[M(r("select",{class:"mx-1","onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),onChange:t[1]||(t[1]=e=>_())},[(m(!0),p(T,null,j(C(c),(e,o)=>(m(),p("option",{key:o,value:o},b(e.name),9,G))),128))],544),[[I,u.value]]),M(r("select",{class:"mx-1","onUpdate:modelValue":t[2]||(t[2]=e=>l.value=e),onChange:t[3]||(t[3]=e=>_())},[(m(!0),p(T,null,j(C(n),(e,o)=>(m(),p("option",{key:o,value:o},b(e.width)+" x "+b(e.height),9,J))),128))],544),[[I,l.value]])]),X])])])])]))}},Z=P(Y);Z.mount("#app");
